(()=>{var a=(n,t)=>{let e;return function(...i){e||(n.apply(this,i),e=!0,setTimeout(()=>e=!1,t))}},s=class extends HTMLElement{constructor(){super(),this.config={maxSteps:10,initialStep:0,debounceTime:50,scrollSensitivity:100,animationSpeed:"normal"},this.currentStep=0,this.isAnimating=!1,this.animationItems=[],this.boundHandleWheel=null,this.boundHandleKeyboard=null,this.lastScrollTime=0,this.scrollAccumulator=0}connectedCallback(){this.init(),this.registerEvents(),this.updateAnimation(),this.hasAttribute("debug")&&console.log("ES Animation initialized:",{config:this.config,items:this.animationItems.length})}disconnectedCallback(){this.cleanup()}init(){this.parseAttributes(),this.animationItems=Array.from(this.querySelectorAll(".es-animation-item")),this.animationItems.length===0&&console.warn("ES Animation: No .es-animation-item elements found"),this.currentStep=this.config.initialStep,this.classList.add("es-animation-container"),this.style.setProperty("--animation-speed",this.getAnimationSpeed())}parseAttributes(){this.config.maxSteps=parseInt(this.getAttribute("max-steps")||this.config.maxSteps,10),this.config.initialStep=parseInt(this.getAttribute("initial-step")||this.config.initialStep,10),this.config.debounceTime=parseInt(this.getAttribute("debounce-time")||this.config.debounceTime,10),this.config.scrollSensitivity=parseInt(this.getAttribute("scroll-sensitivity")||this.config.scrollSensitivity,10),this.config.animationSpeed=this.getAttribute("animation-speed")||this.config.animationSpeed}getAnimationSpeed(){let t={slow:"0.6s",normal:"0.3s",fast:"0.15s"};return t[this.config.animationSpeed]||t.normal}registerEvents(){this.boundHandleWheel=a(this.handleWheel.bind(this),this.config.debounceTime),this.boundHandleKeyboard=this.handleKeyboard.bind(this),window.addEventListener("wheel",this.boundHandleWheel,{passive:!0}),window.addEventListener("keydown",this.boundHandleKeyboard)}handleWheel(t){let e=Math.sign(t.deltaY);this.scrollAccumulator+=Math.abs(t.deltaY),this.scrollAccumulator>=this.config.scrollSensitivity&&(this.changeStep(e),this.scrollAccumulator=0)}handleKeyboard(t){switch(t.key){case"ArrowUp":case"ArrowLeft":t.preventDefault(),this.changeStep(-1);break;case"ArrowDown":case"ArrowRight":t.preventDefault(),this.changeStep(1);break;case"Home":t.preventDefault(),this.goToStep(0);break;case"End":t.preventDefault(),this.goToStep(this.config.maxSteps);break}}changeStep(t){let e=this.currentStep+t;this.goToStep(e)}goToStep(t){let e=Math.max(0,Math.min(t,this.config.maxSteps));e!==this.currentStep&&(this.currentStep=e,this.updateAnimation(),this.dispatchEvent(new CustomEvent("step-change",{detail:{step:this.currentStep,maxSteps:this.config.maxSteps,progress:this.currentStep/this.config.maxSteps},bubbles:!0})))}updateAnimation(){this.isAnimating||(this.isAnimating=!0,requestAnimationFrame(()=>{this.animationItems.forEach(t=>{for(let e=0;e<=this.config.maxSteps;e++)t.classList.remove(`es-animation-step-${e}`),t.style="";for(let e=0;e<=this.currentStep;e++)t.classList.add(`es-animation-step-${e}`),t.style=this.animationItems[e].getAttribute(`data-step-${e}`);t.setAttribute("data-step",this.currentStep)}),this.setAttribute("data-current-step",this.currentStep),this.isAnimating=!1}))}reset(){this.goToStep(this.config.initialStep)}next(){this.changeStep(1)}prev(){this.changeStep(-1)}getCurrentStep(){return this.currentStep}getProgress(){return this.currentStep/this.config.maxSteps*100}cleanup(){this.boundHandleWheel&&window.removeEventListener("wheel",this.boundHandleWheel),this.boundHandleKeyboard&&window.removeEventListener("keydown",this.boundHandleKeyboard)}static get observedAttributes(){return["max-steps","initial-step","animation-speed"]}attributeChangedCallback(t,e,i){if(e!==i)switch(t){case"max-steps":this.config.maxSteps=parseInt(i,10),this.currentStep>this.config.maxSteps&&this.goToStep(this.config.maxSteps);break;case"initial-step":this.config.initialStep=parseInt(i,10);break;case"animation-speed":this.config.animationSpeed=i,this.style.setProperty("--animation-speed",this.getAnimationSpeed());break}}};customElements.define("es-animation",s);new EventSource("/esbuild").addEventListener("change",()=>location.reload());})();
//# sourceMappingURL=animation.js.map
