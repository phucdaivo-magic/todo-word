(()=>{document.addEventListener("DOMContentLoaded",()=>{y(),window.addEventListener("resize",y,{passive:!1})});var y=()=>{let c=document.querySelector(".masonry"),o=document.querySelectorAll(".masonry-item");o.forEach(e=>e.style="");let p=Math.round(c.offsetWidth/o[0].offsetWidth),{push:h,get:i}=g(p),r=()=>{let e={root:null,threshold:.1},n=(t,a)=>{t.forEach(l=>{l.isIntersecting?l.target.style.setProperty("opacity",1):(l.target.style.setProperty("opacity",0),console.log(l))})},s=new IntersectionObserver(n,e);Array.from(o).forEach(t=>{s.observe(t)})};Promise.all(Array.from(o).map(e=>new Promise(n=>{let s=e.querySelector("img");s.complete?n(e):s.onload=()=>n(e)})).map(async(e,n)=>e.then(s=>{let t=i(),a=t.index||t.index===0?t.left:t.left+t.width,l=t.index||t.index===0?t.top+t.height:t.top;s.style.setProperty("position","absolute"),s.style.setProperty("top",`${l}px`),s.style.setProperty("left",`${a}px`),s.style.setProperty("z-index",`${n+1}`),s.style.setProperty("opacity",1);let d=s.getBoundingClientRect(),u=d.width,f=d.height;return h({top:l,left:a,width:u,height:f,item:s},t.index),s}))).then(()=>{r()})},g=c=>{let o=[];return{push:(i,r)=>{r||r===0?o=o.map((e,n)=>n===r?i:e):o.push(i)},get:()=>o.length===0?{top:0,left:0,width:0,height:0}:o.length<c?[...o].pop():{...o.reduce((r,e,n)=>e.top+e.height<=r.top+r.height?{...e,index:n}:r,{...o[0],index:0})}}};new EventSource("/esbuild").addEventListener("change",()=>location.reload());})();
