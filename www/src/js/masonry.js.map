{
  "version": 3,
  "sources": ["../../../src/js/masonry.js"],
  "sourcesContent": ["document.addEventListener(\"DOMContentLoaded\", () => {\r\n\tmasonry();\r\n\twindow.addEventListener('resize', masonry, {\r\n\t\tpassive: false\r\n\t})\r\n});\r\n\r\nconst masonry = () => {\r\n\tconst $masonry = document.querySelector(\".masonry\");\r\n\tconst $masonryItems = document.querySelectorAll(\".masonry-item\");\r\n\r\n\t$masonryItems.forEach(item => item.style = '')\r\n\r\n\tconst col = Math.round($masonry.offsetWidth / $masonryItems[0].offsetWidth);\r\n\r\n\tconst { push, get } = useMasonry(col);\r\n\r\n\tconst onIntersecting = () => {\r\n\t\tconst options = {\r\n\t\t\troot: null,\r\n\t\t\tthreshold: 0.1,\r\n\t\t};\r\n\r\n\t\tconst callback = (entries, observer) => {\r\n\t\t\tentries.forEach((entry) => {\r\n\t\t\t\tif (entry.isIntersecting) {\r\n\r\n\r\n\t\t\t\t\tentry.target.style.setProperty('opacity', 1)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tentry.target.style.setProperty('opacity', 0)\r\n\t\t\t\t\tconsole.log(entry);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t};\r\n\t\tconst observer = new IntersectionObserver(callback, options);\r\n\t\tArray.from($masonryItems).forEach((item) => {\r\n\t\t\tobserver.observe(item);\r\n\t\t});\r\n\t}\r\n\r\n\r\n\tPromise.all(Array.from($masonryItems)\r\n\t\t.map((item) => {\r\n\t\t\treturn new Promise((resolve) => {\r\n\t\t\t\tconst img = item.querySelector(\"img\");\r\n\t\t\t\tif (img.complete) {\r\n\t\t\t\t\tresolve(item);\r\n\t\t\t\t} else {\r\n\t\t\t\t\timg.onload = () => resolve(item);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t})\r\n\t\t.map(async (item, index) => {\r\n\t\t\treturn item.then((item) => {\r\n\t\t\t\tconst itemMasonry = get();\r\n\t\t\t\tconst left =\r\n\t\t\t\t\titemMasonry.index || itemMasonry.index === 0\r\n\t\t\t\t\t\t? itemMasonry.left\r\n\t\t\t\t\t\t: itemMasonry.left + itemMasonry.width;\r\n\r\n\t\t\t\tconst top =\r\n\t\t\t\t\titemMasonry.index || itemMasonry.index === 0\r\n\t\t\t\t\t\t? itemMasonry.top + itemMasonry.height\r\n\t\t\t\t\t\t: itemMasonry.top;\r\n\r\n\t\t\t\titem.style.setProperty(\"position\", \"absolute\");\r\n\t\t\t\titem.style.setProperty(\"top\", `${top}px`);\r\n\t\t\t\titem.style.setProperty(\"left\", `${left}px`);\r\n\t\t\t\titem.style.setProperty(\"z-index\", `${index + 1}`);\r\n\t\t\t\titem.style.setProperty(\"opacity\", 1);\r\n\r\n\t\t\t\tconst itemRect = item.getBoundingClientRect();\r\n\r\n\t\t\t\tconst width = itemRect.width;\r\n\t\t\t\tconst height = itemRect.height;\r\n\r\n\t\t\t\tpush({ top, left, width, height, item }, itemMasonry.index);\r\n\t\t\t\treturn item;\r\n\t\t\t});\r\n\t\t})).then(() => {\r\n\t\t\tonIntersecting();\r\n\t\t})\r\n};\r\n\r\nconst useMasonry = (col) => {\r\n\tlet items = [];\r\n\tconst push = (item, index) => {\r\n\t\tif (index || index === 0) {\r\n\t\t\titems = items.map((_item, _index) => {\r\n\t\t\t\tif (_index === index) {\r\n\t\t\t\t\treturn item;\r\n\t\t\t\t}\r\n\t\t\t\treturn _item;\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\titems.push(item);\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tconst get = () => {\r\n\t\tif (items.length === 0) {\r\n\t\t\treturn {\r\n\t\t\t\ttop: 0,\r\n\t\t\t\tleft: 0,\r\n\t\t\t\twidth: 0,\r\n\t\t\t\theight: 0,\r\n\t\t\t};\r\n\t\t} else if (items.length < col) {\r\n\t\t\treturn [...items].pop();\r\n\t\t} else {\r\n\t\t\tconst topLast = items.reduce(\r\n\t\t\t\t(acc, cur, index) => {\r\n\r\n\t\t\t\t\tif (cur.top + cur.height <= acc.top + acc.height) {\r\n\t\t\t\t\t\treturn { ...cur, index };\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn acc;\r\n\t\t\t\t},\r\n\t\t\t\t{ ...items[0], index: 0 }\r\n\t\t\t);\r\n\r\n\r\n\t\t\treturn {\r\n\t\t\t\t...topLast,\r\n\t\t\t};\r\n\t\t}\r\n\t};\r\n\r\n\treturn { push, get };\r\n};\r\n\r\nnew EventSource(\"/esbuild\").addEventListener(\"change\", () => location.reload());\r\n"],
  "mappings": "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",
  "names": ["masonry", "$masonry", "$masonryItems", "item", "col", "push", "get", "useMasonry", "onIntersecting", "options", "callback", "entries", "observer", "entry", "resolve", "img", "index", "itemMasonry", "left", "top", "itemRect", "width", "height", "items", "_item", "_index", "acc", "cur"]
}
